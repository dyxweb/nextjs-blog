## 网络层面优化
### http2
- 解析速度快。
- 多路复用，多个请求可以共用一个TCP连接。
- 头部压缩，更小的负载体积。
### 静态资源上传到CDN(内容分发网络)
- 将静态资源上传到CDN，用户请求资源时返回就近节点上缓存的资源，不需要每个用户的请求都回源站获取，避免网络拥塞、缓解源站压力，保证用户访问资源的速度和体验。
### 充分利用http缓存
- HTML：使用协商缓存。
- CSS&JS&图片：使用强缓存，将打包的文件名加上contenthash。
### 自托管第三方资源
- 第三方资源官方的cdn比较慢的情况下可以考虑自托管三方资源，根据项目实际情况进行使用。
### DNS优化
#### 减少DNS请求次数
#### 缩短DNS解析时间dns-prefetch（DNS预解析）
- 提前解析之后可能会用到的域名，使解析结果缓存到系统缓存中，缩短DNS解析时间，进而提高网站的访问速度。适用于网页引用了大量其他域名的资源。
- dns-prefetch需慎用，多页面应用重复DNS预解析会增加重复DNS查询次数导致过量的DNS解析，对网络是一种负担。
```
// 用meta标签来告知浏览器当前页面要做DNS预解析。
<meta http-equiv="x-dns-prefetch-control" content="on" />

// 用link标签对指定域名做DNS预解析。
<link rel="dns-prefetch" href="https://www.baidu.com/" />
```
#### dns-prefetch原理
> 当浏览器访问一个域名的时候，需要解析一次DNS获得对应域名的ip地址。解析过程按照如下顺序逐步读取缓存直到拿到IP地址。dns-prefetch就是将解析后的IP缓存在系统中。因为dns-prefetch在本地操作系统做了DNS缓存，使得DNS在解析的过程中，提前在系统缓存中找到了对应IP，后续的解析步骤就不用执行了，有效地缩短了DNS解析时间。

- 浏览器缓存
- 系统缓存
- 路由器缓存
- ISP(运营商)DNS缓存
- 根域名服务器
- 顶级域名服务器
- 主域名服务器
#### DNS解析耗时
> dns-prefetch可以给DNS解析过程带来15-300ms的提升，尤其是一些大量引用很多其他域名资源的网站，提升效果就更加明显了。

- 假如浏览器首次将一个域名解析为IP地址，并缓存至操作系统，那么下一次DNS解析时间可以低至0-1ms。
- 假如解析结果不缓存在系统，那么就需要读取路由器的缓存，进而后续的解析时间最小也要约15ms。
- 如果路由器缓存也不存在，则需要读取ISP(运营商)DNS缓存，一般像taobao.com、baidu.com这些常见的域名，读取ISP(运营商)DNS缓存需要的时间在80-120ms，如果是不常见的域名，平均需要200-300ms。大部分的网站到运营商这块都能找到IP。
#### 浏览器DNS缓存
- 现代浏览器为了优化DNS解析，也设有了浏览器DNS缓存。
- 每当在首次DNS解析后会对其IP进行缓存。缓存时长每种浏览器都不一样，比如Chrome的过期时间是1分钟，在这个期限内不会重新请求DNS。
- 每当Chrome浏览器启动的时候，就会自动的快速解析浏览器最近一次启动时记录的前10个域名。所以经常访问的网址就不存在DNS解析的延迟，进而打开速度更快。
- 而dns-prefetch相当于在浏览器缓存之后，在本地操作系统中做了DNS缓存，为的是给浏览器缓存做保障，尽量让DNS解析存储在本地，以此做了又一层的DNS解析优化。
- DNS在系统的缓存时间是大于浏览器的。
#### 浏览器与系统DNS缓存时间
> TTL(Time-To-Live)就是一条域名解析记录在DNS服务器中的存留时间，国内和国际上很多平台的TTL值都是以秒为单位的，很多的默认值都是3600，也就是默认缓存1小时。

- 浏览器DNS缓存的时间跟DNS服务器返回的TTL值无关, 它的缓存时间取决于浏览器自身设置。
- 系统缓存会参考DNS服务器响应的TTL值，但是不完全等于TTL值。
#### dns-prefetch最佳实践
- dns-prefetch仅对跨域域上的DNS查找有效，因此请避免使用它来指向相同域。这是因为到浏览器看到提示时站点域背后的IP已经被解析。
- 考虑将dns-prefetch与preconnect(预连接)搭配使用。
    - 由于dns-prefetch仅执行DNS查找，不像preconnect会建立与服务器的连接。如果站点是通过HTTPS服务的，两者的组合会涵盖DNS解析，建立TCP连接以及执行TLS握手。将两者结合起来可提供进一步减少跨域请求的感知延迟的机会。
    - 如果页面需要建立与许多第三方域的连接，则将它们预先连接会适得其反。preconnect提示最好仅用于最关键的连接，对于其它的连接使用dns-prefetch节省第一步的DNS查找时间即可。
```
<link rel="preconnect" href="https://www.baidu.com/" crossorigin>
<link rel="dns-prefetch" href="https://www.baidu.com/" />
```